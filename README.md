# 📘 asir\_app4\_通用相片索引 v0.41

一個基於 Streamlit 的批次相片索引與處理工具，集成：

* **生成索引表與圖庫**：上傳照片 ZIP，快速生成包含縮圖、檔名、新檔名、拍攝時間、檔案大小等資訊的 Excel 索引表，並同時打包縮圖 ZIP。
* **從 XLSX 批次更名**：根據已生成的索引表，對 ZIP 中原始圖片進行批次更名並嵌入縮圖，輸出新的索引表與重命名後的 ZIP。
* **批次截圖展示**：對上傳的照片 ZIP 進行正方形裁切、拼圖展示，並提供展示圖下載。

---

## 功能模式 (Mode)

1. **生成索引表與圖庫**

   * 上傳含多層目錄的照片 ZIP。
   * 扁平化提取所有圖片、擷取 EXIF 拍攝時間、檔案大小、修改時間等資訊。
   * 產生帶縮圖的 Excel 檔案與照片縮圖 ZIP。

2. **從 XLSX 批次更名**

   * 上傳原始圖庫 ZIP 與對應索引表 XLSX。
   * 根據 `目前檔名` → `新檔名` 自動批次更名，並生成新的索引表與重命名後的圖庫 ZIP。

3. **批次截圖展示**

   * 上傳照片 ZIP。
   * 對照片進行正方形裁切，按指定邊長拼圖展示。
   * 顯示畫布並可點擊下載單張拼圖。

---

## 安裝

```bash
pip install -r requirements.txt
```

**或手動安裝依賴**：

```bash
pip install streamlit pandas Pillow openpyxl xlsxwriter
```

---

## 使用

1. **啟動應用**

   ```bash
   streamlit run asir_app4_通用相片索引.py
   ```
2. 在瀏覽器側邊欄選擇功能模式，並按照提示上傳 ZIP 或 XLSX。
3. 處理完成後，可在頁面底部下載索引表 (XLSX)、圖庫 (ZIP) 或拼圖圖檔 (PNG)。

---

## 配置

* 頁面標題與佈局已在程式中設定，可在 `st.set_page_config` 中自定義。
* 側邊欄可設定 `根目錄路徑`，影響原圖連結的 URL。

---

## 專案結構

```
case4/
├─ asir_app4_通用相片索引.py    # 主程式
├─ requirements.txt             # 依賴清單
├─ README.md                    # 專案說明
└─ .gitignore                   # Git 忽略規則
```

---

## 授權

本專案採用 MIT License，詳見 LICENSE 檔。

在數位時代中，我們每天拍攝大量的照片，但絕大多數僅堆放於資料夾或手機相簿中，無結構、無分類、無說明，也無法有效搜尋與應用。陳警官提出的「通用索引相片簿」構想，正是為了將照片資料化、語意化、結構化，成為有索引、有說明、可搜尋與可視覺化的資訊入口。
